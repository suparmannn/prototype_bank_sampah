<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Go Green - Bank Sampah Unit</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Arial', sans-serif; background-color: #f0fdf4; }
        .mobile-view { width: 100%; max-width: 480px; min-height: 100vh; margin: 0 auto; background: white; position: relative; overflow-x: hidden; }
        .bg-gogreen { background-color: #065f46; }
        .btn-primary { background-color: #059669; color: white; border-radius: 12px; font-weight: bold; width: 100%; padding: 12px; transition: 0.3s; }
        .hidden { display: none; }
        .status-tag { font-size: 9px; padding: 2px 8px; border-radius: 999px; font-weight: bold; text-transform: uppercase; }
        .bg-pending { background-color: #fef3c7; color: #92400e; }
        .bg-active { background-color: #dcfce7; color: #166534; }
    </style>
</head>
<body>

<div class="mobile-view shadow-2xl">

    <div id="screen-dashboard">
        <div class="p-4 bg-green-800 text-white flex items-center">
            <button class="text-xl mr-4">‚Üê</button>
            <h1 class="font-bold uppercase tracking-tight">Bank Sampah Unit A</h1>
            <div class="ml-auto flex gap-3"><span class="text-xs">v1.0</span></div>
        </div>

        <div class="p-4 bg-green-800 pb-10">
            <div class="bg-white/10 p-5 rounded-2xl border border-white/20">
                <p class="text-white opacity-80 uppercase font-bold tracking-widest">Saldo Operasional Bank Sampah. (TBC: Dari buku tabungan Mobile Banking?)</p>
                <h2 class="text-white font-bold mt-1">Rp 25.450.000</h2>
                <p class="text-white-[10px] opacity-60 mt-2 italic">Saldo ini digunakan untuk settlement nasabah.</p>
            </div>
        </div>

        <div class="p-4 -mt-6 grid grid-cols-2 gap-3">
            <div onclick="showScreen('screen-list-dropoff')" class="bg-white p-4 rounded-xl shadow border flex flex-col items-center gap-2 cursor-pointer">
                <span class="text-2xl">üìã</span>
                <span class="text-[10px] font-bold text-gray-600 uppercase">List Drop Off</span>
            </div>
            <div onclick="showScreen('screen-manage-dropoff')" class="bg-white p-4 rounded-xl shadow border flex flex-col items-center gap-2 cursor-pointer">
                <span class="text-2xl">‚öñÔ∏è</span>
                <span class="text-[10px] font-bold text-gray-600 uppercase text-center leading-tight">Kelola Request<br>Drop Off</span>
            </div>
            
            <div onclick="showScreen('screen-history-sell')" class="bg-white p-4 rounded-xl shadow border flex flex-col items-center gap-2 cursor-pointer border-blue-100">
                <span class="text-2xl">üìë</span>
                <span class="text-[10px] font-bold text-gray-600 uppercase text-center leading-tight">Riwayat Jual</span>
            </div>
            <div onclick="showScreen('screen-stock')" class="bg-white p-4 rounded-xl shadow border flex flex-col items-center gap-2 cursor-pointer">
                <span class="text-2xl">üì¶</span>
                <span class="text-[10px] font-bold text-gray-600 uppercase">Stock Management</span>
            </div>
            <div onclick="showScreen('screen-sell')" class="bg-white p-4 rounded-xl shadow border flex flex-col items-center gap-2 cursor-pointer">
                <span class="text-2xl">üöõ</span>
                <span class="text-[10px] font-bold text-gray-600 uppercase text-center leading-tight">Request Pickup<br>(Jual ke Pengepul)</span>
            </div>
            
            <div onclick="showScreen('screen-settlement')" class="bg-white p-4 rounded-xl shadow border flex flex-col items-center gap-2 cursor-pointer col-span-2">
                <span class="text-2xl">üí≥</span>
                <span class="text-[10px] font-bold text-gray-600 uppercase">Settlement Nasabah</span>
            </div>
        </div>
    </div>

    <div id="screen-manage-dropoff" class="hidden pb-20">
        <div class="p-4 flex items-center border-b bg-white sticky top-0 z-10">
            <button onclick="showScreen('screen-dashboard')" class="text-2xl mr-4 text-green-800">‚Üê</button>
            <h1 class="font-bold text-gray-800 text-sm">Data Nasabah</h1>
        </div>

        <div class="p-4 space-y-6">
            <div>
    <label class="text-[11px] font-bold text-gray-800 uppercase tracking-widest">Input Nomor Resi</label>
    <div class="flex gap-2 mt-1">
        <input type="text" id="input-resi-verify" placeholder="Contoh: GG-2026-001" class="flex-1 p-3 border rounded-lg text-sm bg-white outline-none focus:border-green-600">
      <button class="bg-[#111827] text-white px-4 py-2 rounded-lg text-[10px] font-bold flex items-center gap-2">
                        <span class="w-4 h-4 border border-white/50 rounded-full flex items-center justify-center text-[8px]">‚úì</span> Validasi
                    </button>
    </div>
</div>

            <div class="border border-blue-200 bg-blue-50/20 p-4 rounded-lg flex justify-between items-start">
                <div>
                    <p class="text-[11px] font-bold text-blue-900 uppercase">Status Nasabah</p>
                    <p class="text-[10px] text-gray-400 mt-0.5 italic">Hasil inquiry/validasi (mock)</p>
                </div>
                <div class="flex gap-1.5">
                    <span class="bg-gray-100 text-gray-400 text-[9px] font-bold px-2 py-1 rounded-md uppercase">Belum divalidasi</span>
                    <span class="bg-[#111827] text-white text-[9px] font-bold px-2 py-1 rounded-md uppercase">Aktif</span>
                </div>
            </div>

            <div class="border border-blue-200 p-4 rounded-lg grid grid-cols-2 gap-y-4">
                <div>
                    <p class="text-[9px] text-gray-400 font-bold uppercase tracking-wider">Nama</p>
                    <p class="text-sm font-bold text-blue-900">Siti Nur Aulia</p>
                </div>
                <div>
                    <p class="text-[9px] text-gray-400 font-bold uppercase tracking-wider">ID GoGreen</p>
                    <p class="text-sm font-bold text-blue-900">123456</p>
                </div>
                <div><p class="text-[9px] text-gray-400 font-bold uppercase">No Resi</p>
                    <p class="text-sm font-bold text-blue-900 uppercase">GG-2026-001</p></div>
                <div>
                    <p class="text-[9px] text-gray-400 font-bold uppercase tracking-wider">CIF</p>
                    <p class="text-sm font-bold text-blue-900">0001122334</p>
                </div>
                <div>
                    <p class="text-[9px] text-gray-400 font-bold uppercase tracking-wider">Rekening Utama</p>
                    <p class="text-sm font-bold text-blue-900 tracking-widest">**** **** **** 9081</p>
                </div>
            </div>

            <div>
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xs font-bold text-gray-800 uppercase tracking-widest">Rincian Sampah</h3>
                    <button class="bg-[#374151] text-white text-[10px] font-bold px-3 py-1.5 rounded flex items-center gap-1 tracking-wider">+ TAMBAH KATEGORI</button>
                </div>

                <div class="space-y-4">
                    <div class="flex gap-2 items-center">
                        <div class="flex-1">
                            <label class="text-[9px] text-gray-400 uppercase font-bold">Kategori</label>
                            <input type="text" value="Plastik PET" class="w-full p-2.5 border border-blue-100 rounded text-xs text-gray-600 focus:border-green-400 outline-none">
                        </div>
                        <div class="w-32">
                            <label class="text-[9px] text-gray-400 uppercase font-bold">Berat (Kg)</label>
                            <input type="text" placeholder="Contoh: 2.5" class="w-full p-2.5 border border-blue-100 rounded text-xs text-gray-600 focus:border-green-400 outline-none">
                        </div>
                        <button class="mt-4 p-2 text-gray-400 hover:text-red-500 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                            </svg>
                        </button>
                    </div>
                    <div class="flex gap-2 items-center">
                        <div class="flex-1">
                            <label class="text-[9px] text-gray-400 uppercase font-bold">Kategori</label>
                            <input type="text" placeholder="Pilih Kategori" class="w-full p-2.5 border border-blue-100 rounded text-xs text-gray-600 focus:border-green-400 outline-none">
                        </div>
                        <div class="w-32">
                            <label class="text-[9px] text-gray-400 uppercase font-bold">Berat (Kg)</label>
                            <input type="text" placeholder="Contoh: 2.5" class="w-full p-2.5 border border-blue-100 rounded text-xs text-gray-600 focus:border-green-400 outline-none">
                        </div>
                        <button class="mt-4 p-2 text-gray-400">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                            </svg>
                        </button>
                    </div>
                </div>
                <p class="text-[9px] text-blue-400 mt-4 leading-relaxed">Minimal 1 kategori wajib diisi. Berat mendukung desimal (mis. 0.25 Kg).</p>
            </div>

            <div>
                <h3 class="text-xs font-bold text-gray-800 uppercase tracking-widest">Foto Bukti</h3>
                <div class="mt-2 border-2 border-dashed border-gray-100 rounded-2xl h-28 flex flex-col items-center justify-center text-gray-300">
                    <span class="text-3xl mb-1">üì∑</span>
                    <span class="text-[9px] font-bold uppercase tracking-tighter">Ambil Foto Paket Sampah</span>
                </div>
            </div>

            <button onclick="showScreen('screen-dashboard')" class="btn-primary w-full mt-6 shadow-lg uppercase tracking-widest text-[11px]">Simpan & Update Stok</button>
        </div>
    </div>
           
    <div id="screen-list-dropoff" class="hidden">
        <div class="p-4 flex items-center border-b bg-white sticky top-0 z-10">
            <button onclick="showScreen('screen-dashboard')" class="text-2xl mr-4 text-green-800">‚Üê</button>
            <h1 class="font-bold text-gray-800 text-sm">Riwayat Masuk Sampah</h1>
        </div>

        <div class="p-4 bg-gray-50 border-b space-y-3">
            <div class="grid grid-cols-2 gap-3">
                <div>
                    <label class="text-[9px] font-bold text-gray-400 uppercase tracking-tighter">Tgl Mulai</label>
                    <input type="date" class="w-full p-2 border rounded-lg text-xs outline-none focus:border-green-600 shadow-sm text-gray-600 bg-white">
                </div>
                <div>
                    <label class="text-[9px] font-bold text-gray-400 uppercase tracking-tighter">Tgl Selesai</label>
                    <input type="date" class="w-full p-2 border rounded-lg text-xs outline-none focus:border-green-600 shadow-sm text-gray-600 bg-white">
                </div>
            </div>
            <div class="relative">
                <input type="text" placeholder="Cari Nama / No. Resi..." class="w-full p-3 pl-10 border rounded-xl text-xs outline-none focus:border-green-600 shadow-sm">
                <span class="absolute left-3 top-3 opacity-30 text-sm">üîç</span>
            </div>
        </div>

        <div class="p-4 space-y-3 pb-24">
            <div class="bg-green-900 p-4 rounded-2xl text-white mb-6 shadow-md flex justify-between items-center">
                <div>
                    <p class="text-[9px] uppercase font-bold opacity-70 tracking-widest">Total Masuk Hari Ini</p>
                    <p class="text-xl font-black italic">42.50 Kg</p>
                </div>
                <div class="text-right">
                    <p class="text-[9px] uppercase font-bold opacity-70 tracking-widest">Paket Drop-Off</p>
                    <p class="text-xl font-black italic text-green-400">12</p>
                </div>
            </div>

            <h3 class="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-2">Transaksi Terbaru</h3>

           <div onclick="showDetailList('Siti Nur Aulia', 'GG-2026-001', '12.5 Kg', 'Plastik PET', 'VERIFIED')" class="p-4 border rounded-xl bg-white shadow-sm flex justify-between items-center hover:bg-gray-50 transition-all cursor-pointer">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-green-50 rounded-full flex items-center justify-center text-lg">üì¶</div>
                    <div>
                        <p class="text-xs font-bold text-gray-800">Siti Nur Aulia</p>
                        <p class="text-[9px] text-blue-600 font-bold">ID: 123456 ‚Ä¢ Resi: GG-2026-001</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-[10px] font-bold text-blue-900">12.50 Kg</p>
                    <span class="bg-green-100 text-green-700 text-[8px] font-bold px-2 py-0.5 rounded-full uppercase">Verified</span>
                </div>
            </div>

            <div class="p-4 border rounded-xl bg-white shadow-sm flex justify-between items-center opacity-70">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-lg">‚è≥</div>
                    <div>
                        <p class="text-xs font-bold text-gray-800">Budi Setiawan</p>
                         <p class="text-[9px] text-blue-600 font-bold">ID: 654321 ‚Ä¢ Resi: GG-2026-002</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-[10px] font-bold text-gray-400">Belum Timbang</p>
                    <span class="bg-yellow-100 text-yellow-700 text-[8px] font-bold px-2 py-0.5 rounded-full uppercase">Waiting</span>
                </div>
            </div>
        </div>
    </div>

  

    <div id="modal-detail-dropoff" class="hidden fixed inset-0 modal-overlay z-50 flex items-center justify-center p-6">
        <div class="bg-white w-full rounded-3xl p-6 shadow-2xl relative overflow-hidden">
            <div class="bg-green-800 absolute top-0 left-0 right-0 h-1"></div>
            <h3 class="font-bold text-gray-800 text-sm uppercase tracking-widest mb-6 border-b pb-3">Detail Transaksi</h3>
            
            <div class="space-y-4 mb-8">
                <div class="grid grid-cols-2 gap-4">
                    <div><p class="text-[9px] text-gray-400 font-bold uppercase">Nama Nasabah</p><p id="det-name" class="text-xs font-bold text-blue-900">Siti Nur Aulia</p></div>
                    <div><p class="text-[9px] text-gray-400 font-bold uppercase">Kode Resi</p><p id="det-resi" class="text-xs font-bold text-blue-900">GG-2026-001</p></div>
                    
                </div>
                <div>
                    <p class="text-[9px] text-gray-400 font-bold uppercase border-t pt-3 mb-2">Rincian Sampah (View Only)</p>
                    <div class="flex justify-between p-2.5 bg-gray-50 rounded-lg border border-blue-50">
                        <span id="det-cat" class="text-xs font-medium text-gray-600">Plastik PET</span>
                        <span id="det-weight" class="text-xs font-black text-green-800">12.50 Kg</span>
                    </div>
                </div>
                <div>
                    <p class="text-[9px] text-gray-400 font-bold uppercase mb-2">Foto Bukti Saat Penimbangan</p>
                    <div class="h-32 bg-gray-100 rounded-xl border border-dashed flex items-center justify-center text-gray-300">
                        <span class="text-2xl">üì∏</span>
                    </div>
                </div>
            </div>

            <button onclick="closeModalList()" class="w-full py-4 bg-gray-800 text-white rounded-2xl font-bold text-[10px] uppercase tracking-widest shadow-lg">Tutup Rincian</button>
        </div>
    </div>

    <div id="screen-stock" class="hidden">
        <div class="p-4 flex items-center border-b bg-white sticky top-0 z-10">
            <button onclick="showScreen('screen-dashboard')" class="text-2xl mr-4 text-green-800">‚Üê</button>
            <h1 class="font-bold text-gray-800 text-sm uppercase tracking-tight">Stock Management (Riil)</h1>
        </div>

        <div class="p-5 space-y-5 pb-24">
            <div class="bg-blue-50 p-4 rounded-xl border border-blue-100 flex gap-3 shadow-sm">
                <div class="w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-[10px] font-bold shrink-0">i</div>
                <p class="text-[10px] text-blue-800 leading-tight italic">
                    Data ini adalah berat fisik sampah yang tersedia di gudang Unit Bank Sampah Anda saat ini. 
                    Jika qty Hold (Pending Jual) proses jualnya di approve oleh pengepul, maka value qty Hold (Pending Jual) akan 
                    mengurangi stok management. Jika di tolak pengepul , maka stock management bertambah dari qty Hold (Pending Jual).
                </p>
            </div>

            <div class="relative mt-2">
                <label class="text-[9px] font-bold text-gray-400 uppercase tracking-widest ml-1 mb-1 block">Filter Berdasarkan Tipe</label>
                <select id="filter-stock-type" onchange="filterStockList()" class="w-full p-3 border rounded-xl text-xs bg-white shadow-sm outline-none focus:border-green-600 appearance-none bg-[url('data:image/svg+xml;charset=UTF-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%239ca3af%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpolyline%20points%3D%226%209%2012%2015%2018%209%22%3E%3C%2Fpolyline%3E%3C%2Fsvg%3E')] bg-[length:1.2em] bg-[right_1rem_center] bg-no-repeat">
                    <option value="ALL">SEMUA TIPE SAMPAH</option>
                    <option value="PLASTIK">TIPE: PLASTIK</option>
                    <option value="KERTAS">TIPE: KERTAS / KARTON</option>
                    <option value="LOGAM">TIPE: LOGAM / BESI</option>
                </select>
            </div>

            <div id="stock-list-container" class="space-y-4 mt-6">
                <h3 class="text-[11px] font-black text-blue-900 border-l-4 border-blue-900 pl-2 uppercase tracking-widest mb-4">Rincian Stok Barang</h3>

                <div class="stock-card-item p-4 border rounded-2xl bg-white shadow-sm transition-all" data-category="PLASTIK">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center gap-3">
                            
                            <div>
                                <p class="text-xs font-black text-gray-800 uppercase tracking-tighter">Plastik PET</p>
                                <p class="text-[9px] text-gray-400 font-bold">Kategori: <span class="text-blue-600">Plastik</span></p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-[8px] text-gray-400 font-bold uppercase">Total Berat Riil</p>
                            <p class="text-lg font-black text-green-700 italic">150.25 Kg</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-2 border-t pt-3 border-gray-50">
                        <div class="bg-gray-50 p-2 rounded-lg text-center">
                            <p class="text-[8px] text-gray-400 uppercase font-bold">Masuk Terakhir</p>
                            <p class="text-[10px] font-bold text-gray-700">18 Jan 2026</p>
                        </div>
                        <div class="bg-gray-50 p-2 rounded-lg text-center border border-orange-100">
                            <p class="text-[8px] text-orange-400 uppercase font-bold">Hold (Pending Jual)</p>
                            <p class="text-[10px] font-bold text-orange-600">0.00 Kg</p>
                        </div>
                    </div>
                </div>

                <div class="stock-card-item p-4 border rounded-2xl bg-white shadow-sm transition-all" data-category="PLASTIK">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center gap-3">
                           
                            <div>
                                <p class="text-xs font-black text-gray-800 uppercase tracking-tighter">Plastik HDPE</p>
                                <p class="text-[9px] text-gray-400 font-bold">Kategori: <span class="text-blue-600">Plastik</span></p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-[8px] text-gray-400 font-bold uppercase">Total Berat Riil</p>
                            <p class="text-lg font-black text-green-700 italic">85.00 Kg</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-2 border-t pt-3 border-gray-50">
                        <div class="bg-gray-50 p-2 rounded-lg text-center">
                            <p class="text-[8px] text-gray-400 uppercase font-bold">Masuk Terakhir</p>
                            <p class="text-[10px] font-bold text-gray-700">17 Jan 2026</p>
                        </div>
                        <div class="bg-gray-50 p-2 rounded-lg text-center border border-orange-100">
                            <p class="text-[8px] text-orange-400 uppercase font-bold">Hold (Pending Jual)</p>
                            <p class="text-[10px] font-bold text-orange-600">50.25 Kg</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


  <div id="modal-detail-sell" class="hidden fixed inset-0 modal-overlay z-50 flex items-center justify-center p-6">
    <div class="bg-white w-full rounded-3xl overflow-hidden shadow-2xl relative animate-slide-up">
        <div class="bg-[#1b4332] p-4 text-white flex justify-between items-center">
            <h3 class="font-bold text-[10px] uppercase tracking-widest">Detail Request Pickup</h3>
            <button onclick="closeDetailSell()" class="text-lg opacity-70">‚úï</button>
        </div>

        <div class="p-6 space-y-6 max-h-[80vh] overflow-y-auto text-left">
            <div class="flex justify-between items-start border-b pb-4">
                <div>
                    <p id="det-sell-pengepul" class="font-black text-blue-900 text-lg uppercase tracking-tighter">--</p>
                    <p id="det-sell-date" class="text-[11px] text-gray-400 font-bold">--</p>
                </div>
                <span id="det-sell-status" class="text-[10px] font-black px-3 py-1 rounded-full uppercase">--</span>
            </div>

            <div>
                <p class="text-[10px] font-black text-gray-400 uppercase mb-3 tracking-widest">Daftar Item & Berat</p>
                <div id="det-sell-items" class="space-y-2"></div>
            </div>

            <div id="pay-info-interbank" class="hidden space-y-3">
                <p class="text-[10px] font-black text-gray-400 uppercase tracking-widest">Bukti Transfer Antar Bank</p>
                <div class="h-48 bg-gray-100 rounded-3xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center relative overflow-hidden">
                    <span class="text-4xl mb-2">üì∏</span>
                    <span class="text-[9px] font-black text-gray-400 uppercase italic">Preview Bukti Pembayaran</span>
                    <div class="absolute inset-0 bg-green-900/5 flex items-center justify-center">
                        <p class="text-[14px] font-black text-green-800/20 rotate-12 uppercase tracking-[10px] border-4 border-green-800/10 px-4 py-2 rounded-xl">Verified</p>
                    </div>
                </div>
            </div>

            <div id="pay-info-cbs" class="hidden bg-blue-900 p-5 rounded-[32px] text-white shadow-lg relative overflow-hidden">
                <p class="text-[9px] font-bold opacity-70 uppercase tracking-widest">History Transaksi CBS</p>
                <p class="text-[12px] font-medium mt-1 leading-tight">Dana masuk otomatis via CBS Internal Transfer.</p>
                <p class="text-[12px] font-black mt-3 text-green-400 tracking-wider">Ref ID: GG-TX-778822910</p>
                <div class="absolute -right-4 -bottom-4 opacity-10 text-6xl italic font-black">CBS</div>
            </div>

            <div id="info-expired" class="hidden bg-red-50 p-4 rounded-2xl border border-red-100">
                <p class="text-[10px] text-red-600 font-bold italic text-center">
                    ‚ö† Request Kadaluarsa (Melebihi 24 Jam). Stok dikembalikan ke gudang.
                </p>
            </div>

            <div class="bg-gray-50 p-5 rounded-[32px] border border-gray-100 space-y-3">
                <div class="flex justify-between text-[11px] font-bold text-gray-400 uppercase">
                    <span>Total Berat</span>
                    <span id="det-sell-total-weight" class="text-gray-800">-- Kg</span>
                </div>
                <div class="flex justify-between items-center border-t pt-3">
                    <span class="text-xs font-black text-gray-800 uppercase">Dana Penjualan</span>
                    <span id="det-sell-total-price-final" class="text-xl font-black text-green-700 italic">Rp --</span>
                </div>
            </div>

            <button onclick="closeDetailSell()" class="w-full py-4 bg-gray-800 text-white rounded-2xl font-bold text-[10px] uppercase tracking-widest shadow-lg">Tutup Rincian</button>
        </div>
    </div>
</div>
    
        
    <div id="screen-settlement" class="hidden pb-40">
        <div class="p-4 flex items-center border-b bg-white sticky top-0 z-10">
            <button onclick="showScreen('screen-dashboard')" class="text-2xl mr-4 text-green-800">‚Üê</button>
            <h1 class="font-bold text-gray-800 text-sm uppercase">Pending Settlement</h1>
        </div>

        <div class="p-4 space-y-4">
            <div class="bg-green-900 p-5 rounded-2xl text-white shadow-lg relative overflow-hidden">
                <div class="z-10 relative">
                    <p class="text-[9px] uppercase font-bold opacity-70 tracking-widest">Saldo Bank Sampah </p>
                    <p id="bank-balance" class="text-2xl font-black italic">Rp 25.450.000</p>
                    <p class="text-[8px] mt-2 opacity-60 italic">*Saldo harus mencukupi sebelum settlement diproses.</p>
                </div>
                <div class="absolute -right-4 -bottom-4 opacity-10 text-7xl italic font-black">Rp</div>
            </div>

            <div class="grid grid-cols-2 gap-3">
                <div class="bg-gray-50 p-3 rounded-xl border border-gray-100">
                    <p class="text-[8px] text-gray-400 font-bold uppercase">Total Nasabah</p>
                    <p class="text-sm font-black text-gray-800">12 Orang</p>
                </div>
                <div class="bg-orange-50 p-3 rounded-xl border border-orange-100">
                    <p class="text-[8px] text-orange-400 font-bold uppercase">Total Kewajiban</p>
                    <p id="total-obligation" class="text-sm font-black text-orange-700">Rp 125.000</p>
                </div>
            </div>

            <div class="flex justify-between items-center pt-2">
                <h3 class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Daftar Transaksi Pending</h3>
                <button onclick="processBatchSettlement()" class="bg-green-700 text-white px-4 py-2 rounded-lg text-[9px] font-bold uppercase shadow-md">Bayar Semua (Batch)</button>
            </div>

            <div id="settlement-list" class="space-y-3">
                <div class="p-4 border rounded-2xl bg-white shadow-sm space-y-3 border-l-4 border-l-orange-400">
                    <div class="flex justify-between items-start">
                        <div>
                            <p class="text-[10px] font-bold text-gray-400 uppercase">Drop-Off: 17 Jan 2026</p>
                            <p class="text-xs font-bold text-gray-800">Siti Nur Aulia</p>
                            <p class="text-[9px] text-blue-600 font-medium">Rek: **** **** 9081</p>
                        </div>
                        <span class="bg-orange-100 text-orange-700 text-[8px] font-bold px-2 py-0.5 rounded-full uppercase tracking-tighter">Pending Settlement</span>
                    </div>
                    <div class="flex justify-between items-center border-t pt-2">
                        <div>
                            <p class="text-[8px] text-gray-400 uppercase font-bold">Reward Nasabah</p>
                            <p class="font-black text-green-700 text-sm">Rp 125.000</p>
                        </div>
                        <button onclick="processSingleSettlement('Siti Nur Aulia', 125000, '9081')" class="bg-gray-800 text-white px-3 py-1.5 rounded-lg text-[9px] font-bold uppercase">Proses</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-process-settlement" class="hidden fixed inset-0 modal-overlay z-50 flex items-center justify-center p-6">
        <div class="bg-white w-full rounded-3xl overflow-hidden shadow-2xl relative max-w-sm animate-slide-up">
            <div class="bg-[#1b4332] p-4 text-white">
                <h3 class="font-bold text-xs uppercase tracking-widest">Konfirmasi Instruksi Pembayaran</h3>
            </div>
            <div class="p-6 space-y-4">
                <div class="text-center pb-2">
                    <p class="text-[9px] text-gray-400 uppercase font-bold">Settlement Batch ID</p>
                    <p id="batch-id-display" class="font-black text-blue-900 tracking-tighter text-sm">SET-20260118-XXXX</p>
                </div>
                
                <div class="space-y-3 bg-gray-50 p-4 rounded-2xl border border-gray-100">
                    <div>
                        <p class="text-[8px] text-gray-400 font-bold uppercase">Rekening Sumber (Bank Sampah)</p>
                        <p class="text-xs font-bold text-gray-800">0001-XXXX-XXXX-8822</p>
                    </div>
                    <div class="border-t border-dashed border-gray-300 my-2"></div>
                    <div>
                        <p class="text-[8px] text-gray-400 font-bold uppercase">Rekening Tujuan (Nasabah)</p>
                        <p id="modal-dest-acc" class="text-xs font-bold text-gray-800">**** **** **** 9081</p>
                    </div>
                    <div>
                        <p class="text-[8px] text-gray-400 font-bold uppercase mt-2">Nominal Transfer</p>
                        <p id="modal-amount" class="text-lg font-black text-green-700">Rp 0</p>
                    </div>
                </div>

                <div id="balance-error" class="hidden p-3 bg-red-50 border border-red-100 rounded-xl text-red-600 text-[9px] font-bold text-center italic">
                    ‚ö† Saldo Bank Sampah tidak mencukupi untuk proses settlement ini!
                </div>
            </div>
            <div class="p-4 grid grid-cols-2 gap-3 bg-gray-50">
                <button onclick="closeSettlementModal()" class="py-3 border rounded-xl font-bold text-[10px] uppercase text-gray-500">Batal</button>
                <button id="btn-confirm-settle" onclick="executeSettlement()" class="py-3 bg-green-700 text-white rounded-xl font-bold text-[10px] uppercase shadow-lg">Konfirmasi</button>
            </div>
        </div>
    </div>

         
           


    <div id="screen-history-sell" class="hidden">
    <div class="p-4 flex items-center border-b bg-white sticky top-0 z-10">
        <button onclick="showScreen('screen-dashboard')" class="text-2xl mr-4 text-green-800">‚Üê</button>
        <h1 class="font-bold text-gray-800 text-sm uppercase">Riwayat Penjualan</h1>
    </div>

    <div class="p-4 space-y-4 pb-24">
        <div class="bg-blue-50 p-3 rounded-lg border border-blue-100 flex gap-2">
                <span class="text-blue-600 text-xs">‚ÑπÔ∏è</span>
                <p class="text-[9px] text-blue-700 italic leading-relaxed">
                    Stok riil di gudang otomatis terpotong saat status berubah menjadi <span class="font-bold">SUCCESS (Approved by Pengepul)</span>.
                </p>
            </div>

      <div onclick="showDetailSell('PT PENGEPUL JAYA UTAMA', '18 Jan 2026 ‚Ä¢ 09:00', 'SUCCESS', '100.00', 'Rp 350.000', 'bg-green-100 text-green-700', 'INTERNAL')" 
     class="p-4 border rounded-2xl bg-white shadow-sm space-y-3 cursor-pointer hover:border-green-300 transition-all border-l-4 border-l-green-600">
    <div class="flex justify-between items-start">
        <div>
            <p class="text-[10px] font-bold text-gray-400">18 Jan 2026 ‚Ä¢ 09:00</p>
            <p class="text-xs font-bold text-gray-800 uppercase tracking-tighter">PT Pengepul Jaya Utama</p>
            <p class="text-[9px] text-blue-600 font-bold uppercase mt-1">Metode: CBS Internal Transfer</p>
        </div>
        <span class="bg-green-100 text-green-700 text-[8px] font-bold px-2 py-0.5 rounded-full uppercase">Success</span>
    </div>
    <div class="flex justify-between items-center text-[11px] border-t pt-2 mt-2">
        <span class="text-gray-500">Total Berat: <span class="font-bold text-gray-800">100.00 Kg</span></span>
        <span class="font-bold text-green-700">Rp 350.000</span>
    </div>
</div>

<div onclick="showDetailSell('LAPAK BERKAH RECYCLE', '17 Jan 2026 ‚Ä¢ 14:20', 'SUCCESS', '50.25', 'Rp 150.750', 'bg-green-100 text-green-700', 'ANTAR', 'BANK BNI')" 
     class="p-4 border rounded-2xl bg-white shadow-sm space-y-3 cursor-pointer hover:border-green-300 transition-all border-l-4 border-l-orange-400">
    <div class="flex justify-between items-start">
        <div>
            <p class="text-[10px] font-bold text-gray-400">17 Jan 2026 ‚Ä¢ 14:20</p>
            <p class="text-xs font-bold text-gray-800 uppercase">Lapak Berkah Recycle</p>
            <p class="text-[9px] text-orange-600 font-bold uppercase mt-1">Metode: Antar Bank (BNI) üì∏</p>
        </div>
        <span class="bg-green-100 text-green-700 text-[8px] font-bold px-2 py-0.5 rounded-full uppercase">Success</span>
    </div>
    <div class="flex justify-between items-center text-[11px] border-t pt-2 mt-2">
        <span class="text-gray-500">Total Berat: <span class="font-bold text-gray-800">50.25 Kg</span></span>
        <span class="font-bold text-green-700">Rp 150.750</span>
    </div>
</div>


        <div onclick="showDetailSell('LAPAK BERKAH RECYCLE', '17 Jan 2026 ‚Ä¢ 14:20', 'WAITING', '50.25', 'Rp 150.750', 'bg-yellow-100 text-yellow-700')" 
             class="p-4 border rounded-2xl bg-white shadow-sm space-y-3 border-l-4 border-l-yellow-400 cursor-pointer">
            <div class="flex justify-between items-start">
                <div><p class="text-[10px] font-bold text-gray-400">17 Jan 2026</p>
                    <p class="text-xs font-bold text-gray-800 uppercase">Lapak Berkah Recycle</p></div>
                <span class="bg-yellow-100 text-yellow-700 text-[8px] font-bold px-2 py-0.5 rounded-full uppercase">Waiting</span>
            </div>
            <div class="flex justify-between items-center text-[11px] border-t pt-2 mt-2">
                <span class="text-gray-500">Total Berat: <span class="font-bold">50.25 Kg</span></span>
                <span class="font-bold">Rp 150.750</span>
            </div>
        </div>
    

    <div onclick="showDetailSell('PT MAJU MUNDUR', '15 Jan 2026', 'EXPIRED', '75.00', 'Rp 225.000', 'bg-gray-200 text-gray-500')" 
     class="p-4 border rounded-2xl bg-gray-50 shadow-sm space-y-3 opacity-60 cursor-pointer hover:opacity-100 transition-all">
    <div class="flex justify-between items-start">
        <div>
            <p class="text-[10px] font-bold text-gray-400">15 Jan 2026</p>
            <p class="text-xs font-bold text-gray-800 uppercase">PT Maju Mundur</p>
        </div>
        <span class="bg-gray-200 text-gray-500 text-[8px] font-bold px-2 py-0.5 rounded-full uppercase">Expired</span>
    </div>
    <div class="flex justify-between items-center text-[11px] border-t border-gray-200 pt-2">
        <span class="text-gray-400">Total Berat: <span class="font-bold text-gray-500">75.00 Kg</span></span>
        <span class="font-bold text-gray-400">Rp 225.000</span>
    </div>
     <p class="text-[8px] text-red-400 italic">Request kadaluarsa (melebihi 1 hari). Stok telah dikembalikan ke stock management.</p>
    </div>
        </div>
</div>


<div id="modal-detail-sell" class="hidden fixed inset-0 modal-overlay z-50 flex items-center justify-center p-6">
    <div class="bg-white w-full rounded-3xl overflow-hidden shadow-2xl relative animate-slide-up max-w-sm">
        <div class="bg-[#1b4332] p-4 text-white flex justify-between items-center">
            <h3 class="font-bold text-[10px] uppercase tracking-widest">Detail Request Pickup</h3>
            <button onclick="closeDetailSell()" class="text-lg opacity-70">‚úï</button>
        </div>

        <div class="p-5 space-y-5 max-h-[70vh] overflow-y-auto text-left">
            
            <div class="flex justify-between items-start border-b pb-3">
                <div>
                    <p id="det-sell-pengepul" class="font-black text-blue-900 text-sm uppercase tracking-tighter">--</p>
                    <p id="det-sell-date" class="text-[10px] text-gray-400 font-bold tracking-tight">--</p>
                </div>
                <span id="det-sell-status" class="text-[9px] font-black px-3 py-1 rounded-full uppercase">--</span>
            </div>

            <div>
                <p class="text-[10px] font-black text-gray-400 uppercase mb-3 tracking-widest">Daftar Item & Berat</p>
                <div id="det-sell-items" class="space-y-2">
                    </div>
            </div>

            <div id="pay-info-interbank" class="hidden space-y-3">
                <div class="flex justify-between items-center">
                    <p class="text-[10px] font-black text-gray-400 uppercase tracking-widest">Bukti Transfer Antar Bank</p>
                    <p id="det-bank-name" class="text-[10px] font-black text-blue-600 uppercase">--</p>
                </div>
                <div class="h-44 bg-gray-100 rounded-3xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center relative overflow-hidden">
                    <span class="text-4xl mb-2">üì∏</span>
                    <span class="text-[9px] font-black text-gray-400 uppercase italic">Preview Bukti Pembayaran</span>
                    <div class="absolute inset-0 bg-green-900/5 flex items-center justify-center">
                        <p class="text-[14px] font-black text-green-800/20 rotate-12 uppercase tracking-[10px] border-4 border-green-800/10 px-4 py-2 rounded-xl">Verified</p>
                    </div>
                </div>
            </div>

            <div id="pay-info-cbs" class="hidden bg-blue-900 p-5 rounded-[32px] text-white shadow-lg relative overflow-hidden">
                <p class="text-[9px] font-bold opacity-70 uppercase tracking-widest leading-relaxed">History Transaksi CBS</p>
                <p class="text-[11px] font-medium mt-1 leading-tight italic">Dana masuk otomatis via CBS Internal Transfer.</p>
                <p class="text-[11px] font-black mt-3 text-green-400 tracking-wider">Ref ID: GG-TX-778822910</p>
                <div class="absolute -right-4 -bottom-4 opacity-10 text-6xl italic font-black">CBS</div>
            </div>

            <div id="info-expired" class="hidden bg-red-50 p-4 rounded-2xl border border-red-100">
                <p class="text-[10px] text-red-600 font-bold italic text-center leading-tight">
                    ‚ö† Request Kadaluarsa (Melebihi 24 Jam). Stok telah dikembalikan ke gudang.
                </p>
            </div>

            <div class="bg-gray-50 p-5 rounded-[32px] border border-gray-100 space-y-3 shadow-inner">
                <div class="flex justify-between text-[11px] font-bold text-gray-400 uppercase tracking-tighter">
                    <span>Total Berat Keseluruhan</span>
                    <span id="det-sell-total-weight" class="text-gray-800">-- Kg</span>
                </div>
                <div class="flex justify-between items-center border-t border-gray-200/50 pt-3">
                    <span class="text-xs font-black text-gray-800 uppercase tracking-tighter">Dana Penjualan</span>
                    <span id="det-sell-total-price-final" class="text-xl font-black text-green-700 italic">Rp --</span>
                </div>
            </div>

        </div>

        <div class="p-4 bg-gray-50 border-t">
            <button onclick="closeDetailSell()" class="w-full py-4 bg-gray-800 text-white rounded-2xl font-bold text-[10px] uppercase tracking-widest shadow-lg active:scale-95 transition-transform">Tutup Rincian</button>
        </div>
    </div>
</div>
                

   <div id="screen-sell" class="hidden pb-32">
        <div class="p-4 flex items-center border-b bg-white sticky top-0 z-10">
            <button onclick="showScreen('screen-dashboard')" class="text-2xl mr-4 text-green-800">‚Üê</button>
            <h1 class="font-bold text-gray-800 text-sm uppercase tracking-tight">Request Jual Ke Pengepul</h1>
        </div>

        <div class="p-5 space-y-6">
            <div class="bg-orange-50 p-4 rounded-xl border border-orange-200">
                <p class="text-[10px] font-bold text-orange-900 leading-tight uppercase">Masa Berlaku Request: 1 Hari</p>
                <p class="text-[9px] text-orange-700 mt-1">Jika tidak direspon pengepul dalam 24 jam, request akan expired otomatis.</p>
            </div>

            <div class="flex justify-between items-center px-1">
                <div class="flex items-center gap-2">
                    <input type="checkbox" id="check-all-sell" onchange="toggleAllSell(this)" class="w-4 h-4 rounded text-green-600 focus:ring-green-500">
                    <label for="check-all-sell" class="text-[10px] font-bold text-gray-500 uppercase tracking-widest">Pilih Semua</label>
                </div>
                <button onclick="sellAllAvailable()" class="text-[10px] font-bold text-blue-600 border border-blue-200 px-3 py-1 rounded-lg bg-blue-50">Jual Semua Stok</button>
            </div>

            <div id="sell-items-container" class="space-y-3">
                <div class="p-4 border rounded-2xl bg-white shadow-sm space-y-4">
                    <div class="flex justify-between items-start">
                        <div class="flex gap-3">
                            <input type="checkbox" class="sell-checkbox w-5 h-5 rounded border-gray-300 text-green-700 mt-1">
                            <div>
                                <p class="text-xs font-bold text-gray-800">Plastik PET</p>
                                <p class="text-[9px] text-gray-400">Hold Stok : <span class="font-bold text-orange-500">0 Kg</span></p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-[8px] text-gray-400 font-bold uppercase">Tersedia</p>
                            <p class="text-xs font-bold text-blue-700"><span class="available-val">150.25</span> Kg</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-2 pt-2 border-t border-gray-50">
                        <input type="number" step="0.01" oninput="calculateTotalSell()" placeholder="Berat yang dijual" class="sell-input flex-1 p-2.5 border rounded-lg text-xs bg-gray-50 outline-none focus:border-green-600">
                        <span class="text-[10px] font-bold text-gray-400 uppercase">Kg</span>
                    </div>
                </div>

                <div class="p-4 border rounded-2xl bg-white shadow-sm space-y-4">
                    <div class="flex justify-between items-start">
                        <div class="flex gap-3">
                            <input type="checkbox" class="sell-checkbox w-5 h-5 rounded border-gray-300 text-green-700 mt-1">
                            <div>
                                <p class="text-xs font-bold text-gray-800">Plastik HDPE</p>
                                <p class="text-[9px] text-gray-400">Hold Stok : <span class="font-bold text-orange-500">0 Kg</span></p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-[8px] text-gray-400 font-bold uppercase">Tersedia</p>
                            <p class="text-xs font-bold text-blue-700"><span class="available-val">85.00</span> Kg</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-2 pt-2 border-t border-gray-50">
                        <input type="number" step="0.01" oninput="calculateTotalSell()" placeholder="Berat yang dijual" class="sell-input flex-1 p-2.5 border rounded-lg text-xs bg-gray-50 outline-none focus:border-green-600">
                        <span class="text-[10px] font-bold text-gray-400 uppercase">Kg</span>
                    </div>
                </div>
            </div>

            <button onclick="addNewTypeSell()" class="w-full py-3 border-2 border-dashed border-gray-200 rounded-xl text-gray-400 font-bold text-[10px] uppercase tracking-widest">+ Tambah Tipe Sampah Lain</button>

            <div class="pt-4">
                <label class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Pilih Pengepul Tujuan</label>
                <select class="w-full p-4 border rounded-xl mt-2 text-sm bg-white shadow-sm outline-none focus:border-green-600 appearance-none bg-[url('data:image/svg+xml;charset=UTF-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%239ca3af%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpolyline%20points%3D%226%209%2012%2015%2018%209%22%3E%3C%2Fpolyline%3E%3C%2Fsvg%3E')] bg-[length:1.2em] bg-[right_1rem_center] bg-no-repeat">
                    <option>-- Pilih Pengepul Terdekat --</option>
                    <option>PT Pengepul Jaya Utama</option>
                    <option>Lapak Berkah Recycle</option>
                </select>
            </div>
        </div>

        <div class="fixed bottom-0 left-0 right-0 max-w-[480px] mx-auto p-4 bg-white border-t shadow-[0_-4px_10px_rgba(0,0,0,0.05)]">
            <div class="bg-blue-900 rounded-xl p-4 mb-4 text-white flex justify-between items-center shadow-md">
                <div>
                    <p class="text-[9px] uppercase font-bold opacity-70 tracking-widest">Total Estimasi Pendapatan</p>
                    <p id="total-sell-price" class="text-xl font-black italic">Rp 0</p>
                </div>
                <div class="text-right">
                    <p id="total-sell-weight" class="text-[10px] font-bold">0 Items</p>
                    <p class="text-[8px] opacity-60 italic">*Berdasarkan Master Harga</p>
                </div>
            </div>
            <button onclick="showScreen('screen-dashboard')" class="btn-primary w-full shadow-lg uppercase tracking-widest text-[11px]">Ajukan Request Penjualan</button>
        </div>
    </div>

</div>

<script>
    // 1. Fungsi Navigasi Terpadu (Penyembunyian Layar Otomatis)
    function showScreen(id) {
        const allScreens = [
            'screen-dashboard', 
            'screen-manage-dropoff', 
            'screen-list-dropoff', 
            'screen-history-sell', // Layar Riwayat Jual
            'screen-stock', 
            'screen-sell', 
            'screen-settlement'
        ];

        allScreens.forEach(s => {
            const el = document.getElementById(s);
            if (el) el.classList.add('hidden');
        });

        const targetEl = document.getElementById(id);
        if (targetEl) targetEl.classList.remove('hidden');
    }

    // 2. Fungsi Settlement via CBS Danagung
    function processSettlement() {
        const confirmPay = confirm("Lanjutkan proses settlement? Dana akan dipindahbukukan dari rekening Bank Sampah ke Nasabah via CBS Danagung.");
        if(confirmPay) {
            alert("Integrasi CBS Berhasil! Status transaksi berubah menjadi SETTLED.");
            showScreen('screen-dashboard');
        }
    }

    // 3. Fungsi Detail Riwayat Drop-Off Nasabah (View Only)
    function showDetailList(name, resi, weight, cat, status) {
        document.getElementById('det-name').innerText = name;
        document.getElementById('det-resi').innerText = resi;
        document.getElementById('det-weight').innerText = weight;
        document.getElementById('det-cat').innerText = cat;
        document.getElementById('modal-detail-dropoff').classList.remove('hidden');
    }

    function closeModalList() {
        document.getElementById('modal-detail-dropoff').classList.add('hidden');
    }

/**
 * Fungsi Menampilkan Detail Jual dengan 4 Kondisi
 * @param {string} status - 'WAITING', 'SUCCESS', atau 'EXPIRED'
 * @param {string} method - 'ANTAR' (Antar Bank), 'INTERNAL' (Internal/CBS), atau '-' (untuk Waiting/Expired)
 */
function showDetailSell(pengepul, date, status, weight, price, statusClass, method) {
    const modal = document.getElementById('modal-detail-sell');
    if (!modal) return;

    modal.classList.remove('hidden');
    
    // 1. Update Data Dasar
    document.getElementById('det-sell-pengepul').innerText = pengepul;
    document.getElementById('det-sell-date').innerText = date;
    document.getElementById('det-sell-total-weight').innerText = weight + " Kg";
    
    const statusEl = document.getElementById('det-sell-status');
    statusEl.innerText = status;
    statusEl.className = `text-[10px] font-black px-3 py-1 rounded-full uppercase ${statusClass}`;

    // 2. Kontrol Elemen Berdasarkan Kondisi
    const infoInterbank = document.getElementById('pay-info-interbank');
    const infoCBS = document.getElementById('pay-info-cbs');
    const infoExpired = document.getElementById('info-expired');
    const priceFinal = document.getElementById('det-sell-total-price-final');

    // Reset Tampilan
    infoInterbank.classList.add('hidden');
    infoCBS.classList.add('hidden');
    infoExpired.classList.add('hidden');

    if (status === 'SUCCESS') {
        priceFinal.innerText = price; // Tampilkan nominal asli
        if (method === 'ANTAR') {
            infoInterbank.classList.remove('hidden'); // Tampilkan Bukti Foto
        } else if (method === 'INTERNAL') {
            infoCBS.classList.remove('hidden'); // Tampilkan Kartu Biru CBS
        }
    } else if (status === 'WAITING') {
        priceFinal.innerText = "-"; // Detail bayar belum ada
    } else if (status === 'EXPIRED') {
        priceFinal.innerText = "-";
        infoExpired.classList.remove('hidden'); // Tampilkan pesan expired
    }

    // Simulasi Item List
    const itemContainer = document.getElementById('det-sell-items');
    itemContainer.innerHTML = `
        <div class="flex justify-between items-center p-4 bg-gray-50 rounded-2xl border border-gray-100 shadow-sm">
            <span class="text-sm font-bold text-gray-700 uppercase">Plastik PET</span>
            <span class="text-sm font-black text-blue-900">${weight} Kg</span>
        </div>
    `;
}

function closeDetailSell() {
    const modal = document.getElementById('modal-detail-sell');
    if (modal) modal.classList.add('hidden');
}

    // 5. Fungsi Checklist & Jual Stok (Request Pickup)
    function toggleAllSell(source) {
        const checkboxes = document.querySelectorAll('.sell-checkbox');
        checkboxes.forEach(cb => cb.checked = source.checked);
        calculateTotalSell();
    }

    function sellAllAvailable() {
        // Selector disesuaikan agar lebih fleksibel mencari class 'sell-item'
        const items = document.querySelectorAll('.sell-item, #sell-items-container > div');
        items.forEach(item => {
            const availableEl = item.querySelector('.available-val');
            const inputEl = item.querySelector('.sell-input');
            const cbEl = item.querySelector('.sell-checkbox');
            
            if(availableEl && inputEl && cbEl) {
                inputEl.value = availableEl.innerText;
                cbEl.checked = true;
            }
        });
        const checkAll = document.getElementById('check-all-sell');
        if(checkAll) checkAll.checked = true;
        calculateTotalSell();
    }

    // 6. Fungsi Hitung Otomatis & Update Label "Hold Stok"
    function calculateTotalSell() {
        const items = document.querySelectorAll('.sell-item, #sell-items-container > div');
        let totalWeight = 0;
        let selectedCount = 0;
        
        items.forEach(item => {
            const cb = item.querySelector('.sell-checkbox');
            const input = item.querySelector('.sell-input');
            const holdLabel = item.querySelector('.hold-val');
            
            if (cb && cb.checked) {
                const val = parseFloat(input.value) || 0;
                if(holdLabel) holdLabel.innerText = val + " Kg"; // Update label Hold Stok (Warna Oranye)
                totalWeight += val;
                selectedCount++;
            } else {
                if(holdLabel) holdLabel.innerText = "0 Kg";
            }
        });

        // Simulasi estimasi harga Rp 3.000/Kg
        const estPrice = totalWeight * 3000;
        
        const priceEl = document.getElementById('total-sell-price');
        const countEl = document.getElementById('total-sell-weight');
        
        if(priceEl) priceEl.innerText = "Rp " + estPrice.toLocaleString('id-ID');
        if(countEl) countEl.innerText = selectedCount + " Tipe Sampah Seleksi";
    }

    // 7. Fungsi Tambah Tipe Sampah (Placeholder)
    function addNewTypeSell() {
        alert("Simulasi: Menarik daftar kategori sampah aktif dari Master Database...");
    }
    // Fungsi Filter Stok Berdasarkan Tipe stok management
    function filterStockList() {
        const filterValue = document.getElementById('filter-stock-type').value;
        const items = document.querySelectorAll('.stock-card-item');

        items.forEach(item => {
            const itemCategory = item.getAttribute('data-category');
            if (filterValue === 'ALL' || itemCategory === filterValue) {
                item.classList.remove('hidden');
            } else {
                item.classList.add('hidden');
            }
        });
    }
    // Global variable untuk simulasi saldo
    let currentBankBalance = 25450000;
    let pendingAmount = 125000;

    function processSingleSettlement(name, amount, acc) {
        const batchID = "SET-" + new Date().getTime(); // GoGreen Backend membentuk Settlement Batch ID
        document.getElementById('batch-id-display').innerText = batchID;
        document.getElementById('modal-dest-acc').innerText = "**** **** **** " + acc;
        document.getElementById('modal-amount').innerText = "Rp " + amount.toLocaleString('id-ID');
        
        pendingAmount = amount;

        // Validasi Saldo Bank Sampah
        if (currentBankBalance < amount) {
            document.getElementById('balance-error').classList.remove('hidden');
            document.getElementById('btn-confirm-settle').disabled = true;
            document.getElementById('btn-confirm-settle').classList.add('opacity-50');
        } else {
            document.getElementById('balance-error').classList.add('hidden');
            document.getElementById('btn-confirm-settle').disabled = false;
            document.getElementById('btn-confirm-settle').classList.remove('opacity-50');
        }

        document.getElementById('modal-process-settlement').classList.remove('hidden');
    }

    function executeSettlement() {
        // Simulasi Validasi Data Transaksi & Penyimpanan Detail
        alert("Sistem melakukan Validasi data transaksi & Penyimpanan detail settlement...");
        
        // Update Status transaksi menjadi SETTLED (logis/pre-posting)
        alert("Status Transaksi diperbarui menjadi: SETTLED (Pre-posting)");
        
        // Pindah dana riil (Simulasi integrasi CBS)
        currentBankBalance -= pendingAmount;
        document.getElementById('bank-balance').innerText = "Rp " + currentBankBalance.toLocaleString('id-ID');
        
        alert("Settlement Berhasil! Dana dipindahkan ke rekening nasabah.");
        closeSettlementModal();
        showScreen('screen-dashboard');
    }

    function closeSettlementModal() {
        document.getElementById('modal-process-settlement').classList.add('hidden');
    }
</script>
</script>
</body>
</html>
